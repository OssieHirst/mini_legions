<%= form_for(@imagevote) do |f| %>
  <% @miniature.collections(:photo).each do |collection| %>

    <% if collection.photo.exists? %>
      <td><div class="photo1">

     <%= link_to image_tag(collection.photo.url(:thumb), :retina => true), collection.photo.url(:original), :retina => true, :class => "image-popup-no-margins" %>
<%= f.radio_button(:collection_id, collection.id) %>
<%= f.hidden_field :voter_id, :value => current_user.id %>
<%= f.hidden_field :voted_id, :value => collection.user.id %>
<%= f.hidden_field :miniature_id, :value => @miniature.id %>

     <p>Painted by <%= link_to collection.user.name, collection.user %></p>
         </div></td>
    <% end %>
  <% end %>
  <%= f.submit "Vote" %>
<% end %>
 </table>

  </div>
</div>

<% provide(:title, 'Vote for the best painted miniature') %>
 <script type="text/javascript">
$(document).ready(function() {
  $('.image-popup-no-margins').magnificPopup({
    type: 'image',
    closeOnContentClick: true,
    closeBtnInside: false,
    fixedContentPos: true,
    mainClass: 'mfp-no-margins mfp-with-zoom', // class to remove default margin from left and right side
    image: {
      verticalFit: true
    },
    zoom: {
      enabled: true,
      duration: 200 // don't foget to change the duration also in CSS
    }
  });
});
</script>